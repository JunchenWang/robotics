% Rz	Ry	Rx	Tx	Ty	Tz  欧拉角顺序是 ZYX 单位degree
NDIreadings = [
63.6639414	-68.6882839	-63.4436567	-66.047	-10.466	-2011.456
69.2083421	-64.1054705	-68.5204821	-66.316	-11.169	-2012.932
55.9221854	-72.8568481	-56.1478412	-65.758	-9.896	-2009.689
73.1963644	-59.2277731	-72.0031929	-66.579	-12.027	-2014.471
43.0396525	-76.6826346	-43.7283329	-65.487	-9.454	-2008.023
76.0509612	-54.2662173	-74.3562267	-66.927	-13.116	-2016.348
21.7757581	-79.5193804	-22.9483751	-65.007	-9.221	-2005.76
66.3006726	-69.3928757	-61.0189136	-68.65	-1.979	-2011.929
60.5331789	-68.1381375	-65.4832897	-64.281	-19.212	-2010.923
69.3125262	-69.9765366	-58.9362598	-71.741	6.233	-2012.168
57.6640204	-67.5260419	-67.7669973	-63.383	-28.021	-2010.095
72.2209615	-70.697712	-56.7309073	-75.578	14.197	-2012.118
54.0548838	-67.0285031	-69.298596	-63.337	-36.838	-2010.074
52.1165365	-65.899687	-51.7143727	-68.664	-11.36	-2020.006
75.7556178	-70.3087714	-76.1644455	-64.48	-10.033	-2003.364
43.6052161	-62.3526209	-42.8484383	-71.586	-12.259	-2028.139
90.9433797	-70.9564456	-91.61519	-63.64	-9.101	-1994.796
37.3004399	-58.3500893	-36.0997255	-75.478	-13.019	-2035.986
105.8838482	-70.0306146	-106.8106921	-63.467	-8.178	-1986.09


];

% x, y, z, Rx, Ry,Rz 欧拉角顺序是 XYZ 单位degree
OmegaReadings = [
25.878	1.331	23.291	-0.45	0	-0.15
25.783	1.247	23.296	-0.45	0.09	4.89
25.947	1.414	23.283	-0.36	0	-5.01
25.671	1.205	23.328	-0.45	0.09	10.02
26.013	1.429	23.297	-0.36	0	-10.05
25.605	1.101	23.339	-0.54	0.18	14.7
26.162	1.554	23.232	-0.36	0	-15.09
25.916	1.311	23.421	-0.27	4.95	-0.15
25.854	1.295	23.169	-0.63	-4.86	-0.15
25.977	1.311	23.413	0	9.99	-0.24
25.806	1.302	23.211	-0.81	-9.99	-0.15
26.048	1.311	23.449	0.27	14.94	-0.24
25.779	1.281	23.14	-1.08	-14.94	-0.24
25.826	1.38	23.478	-5.4	0.36	-0.24
25.891	1.289	23.27	4.59	-0.18	-0.06
25.888	1.4	23.35	-10.35	0.63	-0.24
25.906	1.254	23.254	9.54	-0.45	0.03
25.897	1.435	23.405	-15.3	0.9	-0.33
25.905	1.219	23.155	14.58	-0.72	0.12



];
recordsCount = size(NDIreadings,1);

A = zeros(6, recordsCount);
B = zeros(6, recordsCount);
validateB = zeros(3, recordsCount);
validateBonZYX =  zeros(3, recordsCount);



for n = 1:recordsCount
  A(1:3,n) =  NDIreadings(n,1:3)/180 * pi'   ;
  
  rotm = eul2rotm(OmegaReadings(n,4:6)/180 * pi,'XYZ');
  zyx = rotm2eul(rotm, 'ZYX');
  
  B(1:3,n) = zyx'   ;
    
end


[transformation, err] =  HandEyeCalibration(A,B,2);

% ndi2omegaRotm = eul2rotm(transformation(1:3,1)', 'ZYX');
ndiRefOmega = eul2rotm( NDIreadings(1,1:3)/180 * pi,'ZYX');
ndi2omegaRotm = RotationByAxisAngleRep(transformation(1:3));
for n = 1: recordsCount
    ndiR = eul2rotm( NDIreadings(n,1:3)/180 * pi,'ZYX');
%     ndi2omegaRotm'*ndiRef'*ndiR*ndi2omegaRotm
    B_pre = rotm2eul(ndi2omegaRotm'*ndiRefOmega'*ndiR*ndi2omegaRotm, 'xyz')/pi*180;
    validateB(:,n) = B_pre;
    validateBonZYX(1:3,n) = rotm2eul(ndi2omegaRotm'*ndiRefOmega'*ndiR*ndi2omegaRotm, 'ZYX')/pi*180;

end

 validateB - OmegaReadings(:, 4:6)'

