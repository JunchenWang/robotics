% Rz	Ry	Rx	Tx	Ty	Tz  欧拉角顺序是 ZYX 单位degree
APIreading = [


-1754.053	107.497	1180.382	170.2191	-66.1289	-170.9938
-1699.115	103.708	956.84	109.526	-75.1424	-110.8212
-1715.494	294.508	956.935	109.0555	-74.6797	-94.7092
-1793.209	266.167	1236.215	156.1004	-58.2961	-139.589
-1827.007	-94.309	1238.179	157.941	-58.5991	-175.5803
-1758.529	-125.285	1020.809	-112.7111	-64.8419	89.4939
-1706.382	110.566	1018.556	-152.8853	-79.1866	151.2059
-1678.42	345.311	1281.654	-159.8885	-57.5732	177.6503
-1768.583	-259.352	1251.99	166.1023	-61.2392	157.5071
-1649.683	-64.784	618.875	9.044	-64.103	-27.6396
-1738.168	-344.427	892.445	86.7306	-55.4707	-129.7126

];

APIreading = [APIreading(:,6) ,APIreading(:,5) ,APIreading(:,4 ) , APIreading(:, 1:3)];

% a,b, c,  x, y, z  欧拉角顺序是 ZYX 单位 rad

robotReading = [
0.0393440540079773 -1.1589673239400964 0.00194881040293442 -493.27259288479155 -37.002600444557174 84.20837383213305 
1.135633567421004 -1.3880664926721755 -1.0875288070055626 -503.3388662232322 -37.39106204945095 44.407366763269636 
1.4211174614425668 -1.3819148233759977 -1.0995428681023989 -497.28178895497115 -71.02569277016718 44.507320659877394 
0.6388561723199354 -1.0450373877689922 -0.2986597447842991 -483.61089254351396 -64.55359465723663 94.19996100182252 
0.013763425947616502 -1.0484871040186183 -0.27116618280319416 -483.54826509267275 0.052812086669367736 94.32533751098501 
-1.5557358585204277 -1.0549122319569555 1.2124504305282457 -496.43660674885615 4.40741322992352 55.56066459844351 
-0.7289880506678718 -1.3310372464483187 0.7643273473407788 -501.85128505103086 -38.424435666234466 55.356849539149266 
-0.09236345754205655 -0.9677026837163644 0.44976258655673645 -625.4591587077889 -90.830440091289 123.43354672907 
-0.46845959386369546 -1.083478907204327 -0.11626827272854251 -619.4095116932556 18.026619303742216 117.67147861741608 
2.9421628071121475 -1.127195966461773 3.113794925844357 -638.1287395406047 -18.968856982147923 4.99896806803946 
0.9849507841977352 -1.0466243659440249 -1.6573195746916283 -626.6731920277566 32.351625037873504 53.59266430113388 





];

recordsCount = size(APIreading,1);

A = zeros(6, recordsCount);
B = zeros(6, recordsCount);
validateB = zeros(3, recordsCount);

B0 = eul2rotm(robotReading(1,4:6),'ZYX');
for n = 1:recordsCount
  A(1:3,n) =  APIreading(n,1:3)/180 * pi'   ;
  A(4:6,n) = APIreading(n,4:6);

  Bn =  eul2rotm(robotReading(n,1:3),'ZYX') * B0';
  B(1:3,n) = rotm2eul(Bn, 'ZYX')'  ;
  B(4:6, n) = robotReading(n, 4:6) - robotReading(1, 4:6);
    
end



[transformation, err] =  HandEyeCalibration(A,B,2);

% ndi2omegaRotm = eul2rotm(transformation(1:3,1)', 'ZYX');
TcameraMarker= eul2tform( APIreading(1,1:3)/180 * pi,'ZYX');
ndi2robotRotm = RotationByAxisAngleRep(transformation(1:3));

TflangeCamera = rotm2tform(ndi2robotRotm);

TflangeCamera(1:3,4) = transformation(4:6)';



TflangeMarker = TflangeCamera * TcameraMarker



